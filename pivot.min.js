var pivot=function(){function h(g){return c=[],d=[],e={},a={},b={},f={rowLabels:{},columnLabels:{},summaries:{}},g===undefined&&(g={}),g.fields!==undefined&&K(g.fields),g.filters!==undefined&&F(g.filters),g.rowLabels!==undefined&&bb(g.rowLabels),g.columnLabels!==undefined&&cb(g.columnLabels),g.summaries!==undefined&&db(g.summaries),g.csv!==undefined&&y(g.csv),g.json!==undefined&&x(g.json),pivot}function i(){return h()}function j(){var a=L(),c=-1,d=a.length;while(++c<d)delete a[c].values;return{fields:a,filters:b,rowLabels:t(f.rowLabels),columnLabels:t(f.columnLabels),summaries:t(f.summaries)}}function k(){return{pad:l,padRight:m,padLeft:n,formatDate:o,formatTime:p,isArray:q,isRegExp:r,shallowClone:s,objectKeys:t,objectType:u,sortNumerically:v}}function l(a,b,c,d){d===undefined&&(d=" "),b=b.toString(),d=d.toString();while(b.length<c)a==="left"?b=d+b:b+=d;return b}function m(a,b,c){return l("right",a,b,c)}function n(a,b,c){return l("left",a,b,c)}function o(a){return a.getUTCFullYear()+"-"+n(a.getUTCMonth()+1,2,"0")+"-"+n(a.getUTCDate(),2,"0")}function p(a){return o(a)+" "+n(a.getUTCHours(),2,"0")+":"+n(a.getUTCMinutes(),2,"0")}function q(a){return Array.isArray?Array.isArray(a):u(a)=="array"}function r(a){return u(a)=="regexp"}function s(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function t(a){if(Object.keys)return Object.keys(a);var b=[];for(key in a)b.push(key);return b}function u(a){return{}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()}function v(a){return a.sort(function(a,b){return a-b})}function w(b){var c=[],d={},e=-1,f=b.length;while(++e<f){var g=a[b[e]];g===undefined&&(g=R(b[e])),c.push(g)}return c}function x(a){var b,d=M("pseudo");u(a)==="string"&&(a=JSON.parse(a)),c=[];var e={},f=-1,g=a.length;while(++f<g)f===0?b=w(a[f]):c.push(A(a[f],b,d))}function y(a){var b,d=M("pseudo");c=z(a,function(a,c){if(c!==0)return A(a,b,d);b=w(a)})}function z(a,b){function j(){if(f.lastIndex>=a.length)return d;if(i)return i=!1,c;var b=f.lastIndex;if(a.charCodeAt(b)===34){var e=b;while(e++<a.length)if(a.charCodeAt(e)===34){if(a.charCodeAt(e+1)!==34)break;e++}f.lastIndex=e+2;var g=a.charCodeAt(e+1);return g===13?(i=!0,a.charCodeAt(e+2)===10&&f.lastIndex++):g===10&&(i=!0),a.substring(b+1,e).replace(/""/g,'"')}var h=f.exec(a);return h?(i=h[0].charCodeAt(0)!==44,a.substring(b,h.index)):(f.lastIndex=a.length,a.substring(b))}var c={},d={},e=[],f=/\r\n|[,\r\n]/g,g=0,h,i;f.lastIndex=0;while((h=j())!==d){var k=[];while(h!==c&&h!==d)k.push(h),h=j();if(b&&!(k=b(k,g++)))continue;e.push(k)}return e}function A(a,b,c){var d={},e=-1,f=b.length;while(++e<f){var g=U(b[e].name,a[e]);d[b[e].name]=g,S(b[e].name,g)}e=-1,f=c.length;while(++e<f){var h=c[e],g=U(h.name,h.pseudoFunction(d,h));d[h.name]=g,S(h.name,g)}return d}function B(a){var b={all:E,set:F,apply:G,add:D};return a!==undefined?b[a]:b}function C(a){a===undefined&&(a=b);var c;for(c in a)if(a.hasOwnProperty(c)&&!r(a[c]))if(q(a[c])){var d=-1,e=a[c].length;while(++d<e)a[c][d]=U(c,a[c][d])}else a[c]=U(c,a[c])}function D(a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);C()}function E(){return b}function F(a){b=a,C()}function G(a){var f=d,g=[];a!==undefined&&F(a);var h=I();h?f=d:f=c;var i=f.length,j=t(b).length,k=-1;while(++k<i){var l=f[k],m=0;for(var n in b)b.hasOwnProperty(n)&&l.hasOwnProperty(n)&&H(b[n],l[n])&&(m+=1);m===j&&g.push(l)}return d=g,e=s(b),d}function H(a,b){if(!q(a))return r(a)?a.test(b):b===a;var c=-1,d=a.length;while(++c<d)if(a[c]===b)return!0;return!1}function I(){var a=0,c=t(e).length;for(var d in e)e.hasOwnProperty(d)&&e.hasOwnProperty(d)&&b[d]===e[d]&&(a+=1);return c>0&&a>=c}function J(a){var b={columnLabelable:M("columnLabelable"),rowLabelable:M("rowLabelable"),summarizable:M("summarizable"),filterable:M("filterable"),pseudo:M("pseudo"),add:R,all:L,set:K,get:N};return a!==undefined?b[a]:b}function K(b){a={};var c=-1,d=b.length;while(++c<d)R(b[c])}function L(){var b=[];for(var c in a)a.hasOwnProperty(c)&&(b[a[c].index]=a[c]);return b}function M(b){var c=[];for(var d in a)a.hasOwnProperty(d)&&a[d][b]===!0&&c.push(a[d]);return c}function N(b){return a[b]}function O(a,b){var c=0,d=-1,e=a.length;while(++d<e)c+=a[d][b.dataSource];return c}function P(a,b){return O(a,b)/a.length}function Q(a,b){return a.length}function R(b){u(b)==="string"&&(b={name:b}),b.type===undefined&&(b.type="string"),b.pseudo===undefined&&(b.pseudo=!1),b.rowLabelable===undefined&&(b.rowLabelable=!0),b.columnLabelable===undefined&&(b.columnLabelable=!1),b.filterable===undefined&&(b.filterable=!1),b.dataSource===undefined&&(b.dataSource=b.name);if(b.summarizable&&(b.rowLabelable||b.columnLabelable||b.filterable)){var c=s(b);c.rowLabelable=!1,c.filterable=!1,c.dataSource=b.name,c.summarizable!==!0?c.name=c.name+"_"+c.summarizable:c.name=c.name+"_count",R(c),b.summarizable=!1,b.summarizeFunction=undefined}else if(b.summarizable){if(b.summarizeFunction===undefined){switch(b.summarizable){case"sum":b.summarizeFunction=O;break;case"avg":b.summarizeFunction=P;break;default:b.summarizeFunction=Q}b.summarizable=!0}}else b.summarizable=!1;return b.pseudo&&b.pseudoFunction===undefined&&(b.pseudoFunction=function(a){return""}),b.displayFunction===undefined&&(b.displayFunction=T),b.values={},b.displayValues={},b.index=t(a).length,a[b.name]=b,b}function S(b,c){if(a[b]===undefined||a[b].filterable===!1)return;a[b].values[c]===undefined?a[b].values[c]={count:1,displayValue:a[b].displayFunction(c,b)}:a[b].values[c].count+=1}function T(b,c){var d;u(c)==="string"&&(d=a[c]),d===undefined&&(d=R(c));switch(d.type){case"cents":return"$"+(b/100).toFixed(2);case"currency":return"$"+b.toFixed(2);case"date":return o(new Date(b));case"time":return p(new Date(b));default:return b}}function U(b,c){var d,e;u(b)==="string"&&(d=a[b]),d===undefined&&(d=R(b));switch(d.type){case"integer":case"cents":return u(c)==="number"?c:parseInt(c,10);case"float":case"currency":return u(c)==="number"?c:parseFloat(c,10);case"date":case"time":switch(u(c)){case"number":case"date":return c;default:var f=Date.parse(c);return isNaN(f)&&(f=parseInt(c)),f};default:return c.toString()}}function V(a){var b={raw:c,all:d};return a!==undefined?b[a]:b}function W(){return{all:X,rowLabels:Y,columnLabels:Z,summaries:$}}function X(){return f}function Y(){return{set:bb,get:f.rowLabels}}function Z(){return{set:cb,get:f.columnLabels}}function $(){return{set:db,get:f.summaries}}function _(b,c){u(c)==="string"&&(c=a[c]),f[b][c.name]=c}function ab(a,b){f[a]={};var c=-1,d=b.length;while(++c<d)_(a,b[c])}function bb(a){ab("rowLabels",a)}function cb(a){ab("columnLabels",a)}function db(a){ab("summaries",a)}function eb(){return{data:fb,columns:gb}}function fb(){G(),g={};var b=[],c=-1,e=d.length,h;while(++c<e){var i=d[c],j="";for(var k in f.rowLabels)f.rowLabels.hasOwnProperty(k)&&(j+=k+":"+i[k]+"|");if(g[j]===undefined){g[j]={};for(var k in f.rowLabels)f.rowLabels.hasOwnProperty(k)&&(g[j][k]=a[k].displayFunction(i[k],k));g[j].rows=[]}g[j].rows.push(i)}for(j in g)for(var k in f.summaries)f.summaries.hasOwnProperty(k)&&(g[j][k]=a[k].summarizeFunction(g[j].rows,a[k]),g[j][k]=a[k].displayFunction(g[j][k],k));h=t(g).sort(),c=-1,e=h.length;while(++c<e)b.push(g[h[c]]);return b}function gb(){}"use strict";var a,b,c,d,e,f,g;return h(),{init:h,reset:i,config:j,utils:k,csv:y,json:x,data:V,results:fb,fields:J,filters:B,display:W}}();
