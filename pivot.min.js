var pivot=function(){function h(g){return c=[],d=[],e={},a={},b={},f={rowLabels:{},columnLabels:{},summaries:{}},g===undefined&&(g={}),g.fields!==undefined&&K(g.fields),g.filters!==undefined&&F(g.filters),g.rowLabels!==undefined&&cb(g.rowLabels),g.columnLabels!==undefined&&db(g.columnLabels),g.summaries!==undefined&&eb(g.summaries),g.csv!==undefined&&y(g.csv),g.json!==undefined&&x(g.json),pivot}function i(){return h()}function j(){return{fields:L(),filters:b,rowLabels:t(f.rowLabels),columnLabels:t(f.columnLabels),summaries:t(f.summaries)}}function k(){return{pad:l,padRight:m,padLeft:n,formatDate:o,formatTime:p,isArray:q,isRegExp:r,shallowClone:s,objectKeys:t,objectType:u,sortNumerically:v}}function l(a,b,c,d){d===undefined&&(d=" "),b=b.toString(),d=d.toString();while(b.length<c)a==="left"?b=d+b:b+=d;return b}function m(a,b,c){return l("right",a,b,c)}function n(a,b,c){return l("left",a,b,c)}function o(a){return a.getUTCFullYear()+"-"+n(a.getUTCMonth()+1,2,"0")+"-"+n(a.getUTCDate(),2,"0")}function p(a){return o(a)+" "+n(a.getUTCHours(),2,"0")+":"+n(a.getUTCMinutes(),2,"0")}function q(a){return Array.isArray?Array.isArray(a):u(a)=="array"}function r(a){return u(a)=="regexp"}function s(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function t(a){if(Object.keys)return Object.keys(a);var b=[];for(key in a)b.push(key);return b}function u(a){return{}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()}function v(a){return a.sort(function(a,b){return a-b})}function w(b){var c=[],d={},e=-1,f=b.length;while(++e<f){var g=a[b[e]];g===undefined&&(g=S(b[e])),c.push(g)}return c}function x(a){var b,d=N("pseudo");u(a)==="string"&&(a=JSON.parse(a)),c=[];var e={},f=-1,g=a.length;while(++f<g)f===0?b=w(a[f]):c.push(A(a[f],b,d))}function y(a){var b,d=N("pseudo");c=z(a,function(a,c){if(c!==0)return A(a,b,d);b=w(a)})}function z(a,b){function j(){if(f.lastIndex>=a.length)return d;if(i)return i=!1,c;var b=f.lastIndex;if(a.charCodeAt(b)===34){var e=b;while(e++<a.length)if(a.charCodeAt(e)===34){if(a.charCodeAt(e+1)!==34)break;e++}f.lastIndex=e+2;var g=a.charCodeAt(e+1);return g===13?(i=!0,a.charCodeAt(e+2)===10&&f.lastIndex++):g===10&&(i=!0),a.substring(b+1,e).replace(/""/g,'"')}var h=f.exec(a);return h?(i=h[0].charCodeAt(0)!==44,a.substring(b,h.index)):(f.lastIndex=a.length,a.substring(b))}var c={},d={},e=[],f=/\r\n|[,\r\n]/g,g=0,h,i;f.lastIndex=0;while((h=j())!==d){var k=[];while(h!==c&&h!==d)k.push(h),h=j();if(b&&!(k=b(k,g++)))continue;e.push(k)}return e}function A(a,b,c){var d={},e=-1,f=b.length;while(++e<f){var g=V(b[e].name,a[e]);d[b[e].name]=g,T(b[e].name,g)}e=-1,f=c.length;while(++e<f){var h=c[e],g=V(h.name,h.pseudoFunction(d,h));d[h.name]=g,T(h.name,g)}return d}function B(a){var b={all:E,set:F,apply:G,add:D};return a!==undefined?b[a]:b}function C(a){a===undefined&&(a=b);var c;for(c in a)if(a.hasOwnProperty(c)&&!r(a[c]))if(q(a[c])){var d=-1,e=a[c].length;while(++d<e)a[c][d]=V(c,a[c][d])}else a[c]=V(c,a[c])}function D(a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);C()}function E(){return b}function F(a){b=a,C()}function G(a){var f=d,g=[];a!==undefined&&F(a);var h=I();h?f=d:f=c;var i=f.length,j=t(b).length,k=-1;while(++k<i){var l=f[k],m=0;for(var n in b)b.hasOwnProperty(n)&&l.hasOwnProperty(n)&&H(b[n],l[n])&&(m+=1);m===j&&g.push(l)}return d=g,e=s(b),d}function H(a,b){if(!q(a))return r(a)?a.test(b):b===a;var c=-1,d=a.length;while(++c<d)if(a[c]===b)return!0;return!1}function I(){var a=0,c=t(e).length;for(var d in e)e.hasOwnProperty(d)&&e.hasOwnProperty(d)&&b[d]===e[d]&&(a+=1);return c>0&&a>=c}function J(a){var b={columnLabelable:N("columnLabelable"),rowLabelable:N("rowLabelable"),summarizable:N("summarizable"),filterable:N("filterable"),pseudo:N("pseudo"),clone:L,add:S,all:M,set:K,get:O};return a!==undefined?b[a]:b}function K(b){a={};var c=-1,d=b.length;while(++c<d)S(b[c])}function L(){var b=[];for(var c in a){var d={};for(var e in a[c])a[c].hasOwnProperty(e)&&e!=="values"&&(d[e]=a[c][e]);b.push(d)}return b}function M(){var b=[];for(var c in a)a.hasOwnProperty(c)&&(b[a[c].index]=a[c]);return b}function N(b){var c=[];for(var d in a)a.hasOwnProperty(d)&&a[d][b]===!0&&c.push(a[d]);return c}function O(b){return a[b]}function P(a,b){var c=0,d=-1,e=a.length;while(++d<e)c+=a[d][b.dataSource];return c}function Q(a,b){return P(a,b)/a.length}function R(a,b){return a.length}function S(b){u(b)==="string"&&(b={name:b}),b.type===undefined&&(b.type="string"),b.pseudo===undefined&&(b.pseudo=!1),b.rowLabelable===undefined&&(b.rowLabelable=!0),b.columnLabelable===undefined&&(b.columnLabelable=!1),b.filterable===undefined&&(b.filterable=!1),b.dataSource===undefined&&(b.dataSource=b.name);if(b.summarizable&&(b.rowLabelable||b.columnLabelable||b.filterable)){var c=s(b);c.rowLabelable=!1,c.filterable=!1,c.dataSource=b.name,c.summarizable!==!0?c.name=c.name+"_"+c.summarizable:c.name=c.name+"_count",S(c),b.summarizable=!1,b.summarizeFunction=undefined}else if(b.summarizable){if(b.summarizeFunction===undefined){switch(b.summarizable){case"sum":b.summarizeFunction=P;break;case"avg":b.summarizeFunction=Q;break;default:b.summarizeFunction=R}b.summarizable=!0}}else b.summarizable=!1;return b.pseudo&&b.pseudoFunction===undefined&&(b.pseudoFunction=function(a){return""}),b.displayFunction===undefined&&(b.displayFunction=U),b.values={},b.displayValues={},b.index=t(a).length,a[b.name]=b,b}function T(b,c){if(a[b]===undefined||a[b].filterable===!1)return;a[b].values[c]===undefined?a[b].values[c]={count:1,displayValue:a[b].displayFunction(c,b)}:a[b].values[c].count+=1}function U(b,c){var d;u(c)==="string"&&(d=a[c]),d===undefined&&(d=S(c));switch(d.type){case"cents":return"$"+(b/100).toFixed(2);case"currency":return"$"+b.toFixed(2);case"date":return o(new Date(b));case"time":return p(new Date(b));default:return b}}function V(b,c){var d,e;u(b)==="string"&&(d=a[b]),d===undefined&&(d=S(b));switch(d.type){case"integer":case"cents":return u(c)==="number"?c:parseInt(c,10);case"float":case"currency":return u(c)==="number"?c:parseFloat(c,10);case"date":case"time":switch(u(c)){case"number":case"date":return c;default:var f=Date.parse(c);return isNaN(f)&&(f=parseInt(c)),f};default:return c.toString()}}function W(a){var b={raw:c,all:d};return a!==undefined?b[a]:b}function X(){return{all:Y,rowLabels:Z,columnLabels:$,summaries:_}}function Y(){return f}function Z(){return{set:cb,get:f.rowLabels}}function $(){return{set:db,get:f.columnLabels}}function _(){return{set:eb,get:f.summaries}}function ab(b,c){u(c)==="string"&&(c=a[c]),g=undefined,f[b][c.name]=c}function bb(a,b){f[a]={};var c=-1,d=b.length;while(++c<d)ab(a,b[c])}function cb(a){bb("rowLabels",a)}function db(a){bb("columnLabels",a)}function eb(a){bb("summaries",a)}function fb(){return{all:gb,columns:nb}}function gb(){return g!==undefined?mb():(hb(),t(f.columnLabels)>0?ib():kb(),mb())}function hb(){G(),g={};var b=-1,c=d.length,e;while(++b<c){var h=d[b],i="";for(var j in f.rowLabels)f.rowLabels.hasOwnProperty(j)&&(i+=j+":"+h[j]+"|");if(g[i]===undefined){g[i]={};for(var j in f.rowLabels)f.rowLabels.hasOwnProperty(j)&&(g[i][j]=a[j].displayFunction(h[j],j));g[i].rows=[]}g[i].rows.push(h)}}function ib(){for(var b in g)for(var c in f.columnLabels)if(f.columnLabels.hasOwnProperty(c)){var d=jb(g[b].rows,a[c]);for(value in d)g[b][value]=lb(d[value])}return g}function jb(a,b){var c=-1,d=a.length,e={};while(++c<d){var f=a[c][b.name];e[f]===undefined&&(e[f]={rows:[]}),e[f].rows.push(a[c])}return e}function kb(){for(var a in g)lb(g[a]);return g}function lb(b){var c={};for(var d in f.summaries)f.summaries.hasOwnProperty(d)&&(b[d]=a[d].summarizeFunction(b.rows,a[d]),b[d]=a[d].displayFunction(b[d],d))}function mb(){var a=[],b=t(g).sort(),c=-1,d=b.length;while(++c<d)a.push(g[b[c]]);return a}function nb(){}"use strict";var a,b,c,d,e,f,g;return h(),{init:h,reset:i,config:j,utils:k,csv:y,json:x,data:W,results:fb,fields:J,filters:B,display:X}}();
